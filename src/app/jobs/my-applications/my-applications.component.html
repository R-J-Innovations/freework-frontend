<div class="applications-container container">
  <!-- Header -->
  <div class="applications-header">
    <div class="header-content">
      <h1>My Applications</h1>
      <p class="subtitle">Track and manage all your job applications</p>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Loading your applications...</p>
  </div>

  <!-- Content -->
  <div *ngIf="!loading" class="applications-content">
    <!-- Statistics Cards -->
    <div class="stats-grid">
      <mat-card class="stat-card total-card" (click)="filterByStatus('ALL')">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>folder_open</mat-icon>
          </div>
          <div class="stat-details">
            <span class="stat-value">{{ stats.total }}</span>
            <span class="stat-label">Total Applications</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card pending-card" (click)="filterByStatus(ApplicationStatus.PENDING)">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>schedule</mat-icon>
          </div>
          <div class="stat-details">
            <span class="stat-value">{{ stats.pending }}</span>
            <span class="stat-label">Pending Review</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card accepted-card" (click)="filterByStatus(ApplicationStatus.ACCEPTED)">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>check_circle</mat-icon>
          </div>
          <div class="stat-details">
            <span class="stat-value">{{ stats.accepted }}</span>
            <span class="stat-label">Accepted</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card rejected-card" (click)="filterByStatus(ApplicationStatus.REJECTED)">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>cancel</mat-icon>
          </div>
          <div class="stat-details">
            <span class="stat-value">{{ stats.rejected }}</span>
            <span class="stat-label">Rejected</span>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Empty State -->
    <div *ngIf="applications.length === 0" class="empty-state">
      <mat-icon>work_off</mat-icon>
      <h2>No Applications Yet</h2>
      <p>You haven't applied to any jobs yet. Start browsing available opportunities!</p>
      <button mat-raised-button color="primary" routerLink="/jobs">
        <mat-icon>search</mat-icon>
        Browse Jobs
      </button>
    </div>

    <!-- Applications List -->
    <div *ngIf="filteredApplications.length > 0" class="applications-list">
      <div class="list-header">
        <h2>
          {{ selectedStatus === 'ALL' ? 'All Applications' : selectedStatus + ' Applications' }}
          <span class="count">({{ filteredApplications.length }})</span>
        </h2>
      </div>

      <mat-card *ngFor="let application of filteredApplications" class="application-card elevation-1">
        <mat-card-content>
          <div class="application-main">
            <!-- Job Info -->
            <div class="job-info">
              <h3 class="job-title">{{ application.jobTitle || 'Untitled Job' }}</h3>
              <p class="job-meta">
                <span class="applied-date">
                  <mat-icon>schedule</mat-icon>
                  Applied {{ getTimeAgo(application.appliedAt) }}
                </span>
                <span *ngIf="application.proposedRate" class="proposed-rate">
                  <mat-icon>attach_money</mat-icon>
                  ${{ application.proposedRate }}
                </span>
              </p>

              <!-- Cover Letter Preview -->
              <div class="cover-letter-preview">
                <p class="preview-text">{{ application.message }}</p>
              </div>

              <!-- Portfolio Link -->
              <div *ngIf="application.portfolioLink" class="portfolio-link">
                <mat-icon>link</mat-icon>
                <a [href]="application.portfolioLink" target="_blank" rel="noopener">
                  View Portfolio
                </a>
              </div>
            </div>

            <!-- Status Badge -->
            <div class="application-status">
              <mat-chip-set>
                <mat-chip [class]="getStatusClass(application.status)">
                  <mat-icon>{{ getStatusIcon(application.status) }}</mat-icon>
                  {{ application.status }}
                </mat-chip>
              </mat-chip-set>
            </div>
          </div>

          <!-- Actions -->
          <div class="application-actions">
            <button
              mat-button
              (click)="viewJobDetails(application.jobId)"
            >
              <mat-icon>visibility</mat-icon>
              View Job
            </button>

            <button
              mat-button
              *ngIf="application.status === ApplicationStatus.PENDING"
              (click)="withdrawApplication(application)"
              class="withdraw-button"
            >
              <mat-icon>remove_circle</mat-icon>
              Withdraw
            </button>

            <button
              mat-raised-button
              color="primary"
              *ngIf="application.status === ApplicationStatus.ACCEPTED"
            >
              <mat-icon>message</mat-icon>
              Contact Client
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- No Results for Filter -->
    <div *ngIf="filteredApplications.length === 0 && applications.length > 0" class="no-results">
      <mat-icon>filter_list_off</mat-icon>
      <h3>No {{ selectedStatus }} Applications</h3>
      <p>Try selecting a different filter to view your applications.</p>
      <button mat-button color="primary" (click)="filterByStatus('ALL')">
        Show All Applications
      </button>
    </div>
  </div>
</div>
