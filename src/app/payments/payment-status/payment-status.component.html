<div class="payment-status-container">
  <mat-card class="status-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>timeline</mat-icon>
        Payment Status
      </mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <!-- Current Status Badge -->
      <div class="current-status" *ngIf="currentStatus">
        <mat-chip [color]="getStatusColor(currentStatus)" class="status-chip">
          <mat-icon>{{ statusSteps[getCurrentStep()].icon || 'info' }}</mat-icon>
          {{ currentStatus }}
        </mat-chip>
        <p class="status-message" *ngIf="statusMessage">{{ statusMessage }}</p>
        <p class="last-updated" *ngIf="lastUpdated">
          Last updated: {{ lastUpdated | date:'medium' }}
        </p>
      </div>

      <!-- Progress Bar -->
      <div class="progress-section">
        <mat-progress-bar
          mode="determinate"
          [value]="getProgressPercentage()"
          [color]="getStatusColor(currentStatus || PaymentStatus.PENDING)">
        </mat-progress-bar>
      </div>

      <!-- Status Timeline -->
      <div class="status-timeline">
        <div
          *ngFor="let step of statusSteps; let i = index"
          class="timeline-step"
          [class.completed]="isStepCompleted(i)"
          [class.active]="isStepActive(i)"
        >
          <div class="step-indicator">
            <div class="step-circle">
              <mat-icon *ngIf="isStepCompleted(i)">{{ step.icon }}</mat-icon>
              <span *ngIf="!isStepCompleted(i)">{{ i + 1 }}</span>
            </div>
            <div class="step-line" *ngIf="i < statusSteps.length - 1"></div>
          </div>
          <div class="step-content">
            <h4>{{ step.label }}</h4>
            <p *ngIf="isStepActive(i)">Current Status</p>
            <p *ngIf="isStepCompleted(i) && !isStepActive(i)">Completed</p>
          </div>
        </div>
      </div>

      <!-- Status Descriptions -->
      <div class="status-info">
        <div class="info-item">
          <mat-icon>lock</mat-icon>
          <div class="info-content">
            <h4>Escrowed</h4>
            <p>Payment is held securely until work is completed and approved.</p>
          </div>
        </div>
        <div class="info-item">
          <mat-icon>check_circle</mat-icon>
          <div class="info-content">
            <h4>Released</h4>
            <p>Payment has been released to the freelancer's account.</p>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</div>
